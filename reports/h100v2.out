Detected GPU: NVIDIA H100 80GB HBM3
TORCH_CUDA_ARCH_LIST: 9.0
True NVIDIA H100 80GB HBM3
{'D_learning_rate': 0.0002,
 'batch_size': 4,
 'c2s_checkpoint_path': './results/CA_with_RD/reconstructors/for_iter147200_wpsp_1e-3_8layers/checkpoints/model_epoch_100.pth',
 'c2s_net_type': 'c2smlp',
 'cls_lr': 0.0001,
 'cmlp_checkpoint_path': './results/CA_with_RD/CA_from_145600/config1_lambda_s0.1_lr5e-4/checkpoints/iteration_147200.pt',
 'dataset_type': 'ffhq_glasses',
 'disc_checkpoint_path': './results/CA_with_RD/discriminators/for_iter145600/checkpoints/model_epoch_500.pth',
 'disc_type': 'global',
 'elastic_alpha': 0.0,
 'exp_dir': './results/CA_with_RD/CA_from_147200/stronglr1e-3_100ep_w1.0_Wpsp',
 'exp_scheme': 'improved_loss',
 'id_lambda': 0.4,
 'image_interval': 10000,
 'input_nc': 3,
 'k': 512,
 'keep_optimizer': True,
 'label_nc': 0,
 'lambda_s': 0.1,
 'lasso_direction': 'element',
 'lasso_reg_type': 'traditional',
 'lasso_sbg_lambda': 0.0,
 'lasso_st_lambda': 0.0,
 'lasso_threshold': 0.0001,
 'lasso_weight_lambda': 0.0,
 'lasso_weight_type': 'all',
 'latent_dim': 512,
 'learn_in_w': False,
 'learning_rate': 0.001,
 'log_interval': 100,
 'lpips_lambda': 0.8,
 'lr_CA': 0.001,
 'lr_R': 0.005,
 'max_steps': 150000,
 'mi_loss_method': 'bce',
 'mlp_norm_type': 'nodim',
 'n_branch_layers': 8,
 'n_c2s_layers': 8,
 'n_layers_mlp': 12,
 'n_mut_layers': 2,
 'n_shared_layers': 4,
 'net_type': 'independent',
 'num_D_layers': 2,
 'optim_name': 'adam',
 'output_size': 1024,
 'pSp_checkpoint_path': '../pretrained_models/pSp_models/psp_ffhq_encode.pt',
 'pca_load_path': './PCA',
 'pix_lambda': 1.0,
 'previous_train_ckpt_path': None,
 'print_interval': 10000,
 'recon_loss_type': 'mse',
 'ref_latent_dist': 'cbg',
 'resize_factors': None,
 's_scale_lambda': 0.3,
 'save_interval': 100,
 'save_training_data': True,
 'sbg_lambda': 1.0,
 'sbg_type': 'l2',
 'seed': 42,
 'spatial_encoding': 'none',
 'st_lambda': 1.0,
 'start_from_latent_avg': True,
 'style_dim': 18,
 'stylegan_weights': '../pretrained_models/pSp_models/stylegan2-ffhq1024.pt',
 'test_batch_size': 4,
 'test_workers': 4,
 'train_D_common': False,
 'train_pSp_encoder': False,
 'train_stylegan_decoder': False,
 'use_wandb': False,
 'val_interval': 100,
 'w_cls_lambda': 0.0,
 'w_dist_lambda': 1.0,
 'w_dist_rec_lambda': 0.0,
 'w_dist_swap_lambda': 0.0,
 'w_recon_lambda': 1.0,
 'workers': 4,
 'zero_out_silent_bg': False,
 'zero_out_silent_t': False,
 'zero_out_threshold': 0.0,
 'zero_out_type': 'hard'}
using coach_contrastive_Dist_Recon.py ...
Loading cs encoder from previous checkpoint..../results/CA_with_RD/CA_from_145600/config1_lambda_s0.1_lr5e-4/checkpoints/iteration_147200.pt
Loading pSp from checkpoint: ../pretrained_models/pSp_models/psp_ffhq_encode.pt
Resuming training from weights step 147200
Loaded model from ./results/CA_with_RD/discriminators/for_iter145600/checkpoints/model_epoch_500.pth
Loaded model from ./results/CA_with_RD/reconstructors/for_iter147200_wpsp_1e-3_8layers/checkpoints/model_epoch_100.pth
Loading ResNet ArcFace
Loading dataset for ffhq_glasses
Number of training samples: 10000
Number of test samples: 3500
OMG, finished training!
